# 项目功能介绍 📖

> **ai-rag-knowledge-study** - 一个基于 Spring AI 的 RAG 知识库应用

---

## 🎯 项目定位

这是一个**企业级 AI 知识库应用**，让你能够：
- 与 AI 进行智能对话
- 上传自己的文档，让 AI 基于你的资料回答问题
- 支持本地 AI 模型（Ollama）和云端 API（OpenAI 等）

**一句话概括**：把你的文档变成可对话的智能知识库。

---

## 🖥️ 核心功能

### 1️⃣ AI 智能对话

| 功能 | 说明 |
|------|------|
| 流式对话 | 实时输出 AI 回复，打字机效果 |
| 多模型支持 | 支持 Ollama 本地模型和 OpenAI 等云端 API |
| 模型切换 | 在界面上自由切换不同 AI 模型 |
| Markdown 渲染 | 支持代码高亮、表格等富文本展示 |

**访问页面**：`ai-chat.html`

```
用户输入问题
    ↓ 流式请求
后端 AiController
    ↓ 调用 AI 模型
实时返回回答（SSE 流式响应）
```

---

### 2️⃣ RAG 知识库问答

> **核心亮点**：让 AI 基于**你的文档**回答问题，而不是只靠训练数据。

| 功能 | 说明 |
|------|------|
| 文档上传 | 支持 PDF、TXT、MD 等格式 |
| Git 仓库导入 | 直接导入 GitHub 仓库代码作为知识库 |
| 语义搜索 | 基于向量相似度检索最相关的内容 |
| 知识库管理 | 按标签分类管理不同知识库 |

**访问页面**：`knowledge.html`（管理）、`upload.html`（上传）

**工作流程**：
```
┌─────────────────────────────────────────────────────────────┐
│                      知识库构建阶段                          │
├─────────────────────────────────────────────────────────────┤
│  上传文档/导入 Git 仓库                                      │
│        ↓                                                    │
│  文档分割成小块 (Chunks)                                     │
│        ↓                                                    │
│  Embedding 模型转换为向量                                    │
│        ↓                                                    │
│  存储到 PostgreSQL (pgvector)                               │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                      知识库问答阶段                          │
├─────────────────────────────────────────────────────────────┤
│  用户提问："项目的部署方式是什么？"                           │
│        ↓                                                    │
│  问题转向量 → 向量数据库检索相关文档                          │
│        ↓                                                    │
│  组合 Prompt = 问题 + 检索到的上下文                         │
│        ↓                                                    │
│  LLM 生成回答（基于检索内容）                                 │
└─────────────────────────────────────────────────────────────┘
```

---

### 3️⃣ 模型配置管理

| 功能 | 说明 |
|------|------|
| 多配置管理 | 保存多个 AI 服务配置（Ollama、OpenAI、SiliconFlow 等） |
| 配置激活 | 一键切换当前使用的 AI 服务 |
| Embedding 配置 | 独立管理向量化模型配置 |
| 连接测试 | 验证 API 配置是否正确 |
| 模型列表获取 | 自动拉取可用模型列表 |

**访问页面**：`model-config.html`

**支持的 AI 服务商**：
- **Ollama**（本地部署，免费）
- **OpenAI**（GPT-4、GPT-3.5 等）
- **SiliconFlow**（国内 API 代理）
- 其他 OpenAI 兼容接口

---

## 📄 前端页面

| 页面 | 路径 | 功能 |
|------|------|------|
| AI 对话 | `/ai-chat.html` | 与 AI 聊天，支持 RAG 模式 |
| 知识库管理 | `/knowledge.html` | 查看和删除知识库标签 |
| 文档上传 | `/upload.html` | 上传文档或导入 Git 仓库 |
| 模型配置 | `/model-config.html` | 管理 AI 服务配置 |

---

## 🔌 后端 API

### AI 对话接口 (`/api/v1/ai/`)

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/generate` | 同步生成回复 |
| GET | `/generate_stream` | 流式生成回复 (SSE) |
| GET | `/generate_stream_rag` | RAG 模式流式对话 |

### 知识库接口 (`/api/v1/rag/`)

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/query_rag_tag_list` | 获取知识库标签列表 |
| POST | `/delete_rag_tag` | 删除知识库标签 |
| GET | `/tag_count` | 查询知识库向量数量 |
| POST | `/file/upload` | 上传知识库文件 |
| POST | `/analyze_git_repository` | 导入 Git 仓库 |
| GET | `/query_task_progress` | 查询任务进度 |
| POST | `/cancel_task` | 取消任务 |

### 模型配置接口 (`/api/v1/llm/`)

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/configs` | 获取所有配置 |
| POST | `/configs` | 新增配置 |
| PUT | `/configs/{id}` | 更新配置 |
| DELETE | `/configs/{id}` | 删除配置 |
| POST | `/configs/{id}/activate` | 激活配置 |
| POST | `/configs/{id}/activate-embedding` | 激活 Embedding 配置 |
| GET | `/configs/active` | 获取当前激活配置 |
| POST | `/configs/test` | 测试配置连接 |

---

## 🏗️ 技术架构

```
┌─────────────────────────────────────────────────────────────┐
│                       前端 (静态页面)                        │
│          ai-chat.html | knowledge.html | upload.html        │
│                      model-config.html                       │
└─────────────────────────┬───────────────────────────────────┘
                          │ HTTPS / HTTP
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                    Nginx (反向代理)                          │
│                 静态资源 + API 代理 + HTTPS                   │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│              Spring Boot 3.2 + Spring AI 1.0                │
├─────────────────────────────────────────────────────────────┤
│  xfg-dev-tech-trigger  │  HTTP 适配器层（Controller）        │
│  xfg-dev-tech-domain   │  领域服务层（业务逻辑）              │
│  xfg-dev-tech-api      │  接口定义层（DTO、接口）             │
│  xfg-dev-tech-app      │  应用启动层 + 静态资源               │
└────────┬─────────────────┬────────────────────┬─────────────┘
         │                 │                    │
         ▼                 ▼                    ▼
┌────────────────┐ ┌────────────────┐ ┌────────────────┐
│  PostgreSQL    │ │     Redis      │ │    Ollama      │
│   + pgvector   │ │  (配置缓存)    │ │ (本地 AI 推理)  │
└────────────────┘ └────────────────┘ └────────────────┘
```

---

## 📦 模块说明

| 模块 | 职责 |
|------|------|
| **xfg-dev-tech-api** | 定义接口、DTO、响应格式 |
| **xfg-dev-tech-domain** | 核心业务逻辑、领域服务 |
| **xfg-dev-tech-trigger** | HTTP 触发器层（Controller） |
| **xfg-dev-tech-app** | 应用启动、配置、静态资源 |

项目采用 **DDD (领域驱动设计)** 架构风格。

---

## 🎯 使用场景

| 场景 | 说明 |
|------|------|
| **企业知识库** | 上传公司文档，员工可智能问答 |
| **代码助手** | 导入项目仓库，快速了解代码 |
| **学习笔记** | 上传学习资料，随时回顾知识点 |
| **客服机器人** | 基于产品文档的智能客服 |

---

## 🚀 快速体验

1. **部署服务**：参考 Docker 部署文档
2. **配置模型**：在 `model-config.html` 添加 AI 服务配置
3. **上传文档**：在 `upload.html` 上传你的文档
4. **开始对话**：在 `ai-chat.html` 选择知识库并提问

---

> 💡 通过这个项目，你可以学习到：Spring AI、RAG 架构、向量数据库、流式响应等现代 AI 应用开发技术。

---

## 📚 文档导航

| 上一篇 | 下一篇 |
|--------|--------|
| [07-验证与排查](./07-验证与排查.md) | - |

[返回目录](./README.md)
