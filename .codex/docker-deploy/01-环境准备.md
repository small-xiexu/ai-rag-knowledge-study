# 01 - ç¯å¢ƒå‡†å¤‡

> æœ¬ç« ä»‹ç»å¦‚ä½•åœ¨ macOSã€Ubuntu æœ¬åœ°æˆ–äº‘æœåŠ¡å™¨ä¸Šå®‰è£… Dockerï¼Œä¸ºåç»­éƒ¨ç½²åšå¥½å‡†å¤‡ã€‚

---

## ğŸ“‹ æœ¬ç« ç›®æ ‡

å®Œæˆæœ¬ç« åï¼Œä½ å°†èƒ½å¤Ÿï¼š
- âœ… ç†è§£ Docker Desktop ä¸ Docker Engine çš„åŒºåˆ«
- âœ… åœ¨æœ¬æœºæˆ–äº‘æœåŠ¡å™¨å®‰è£…å¹¶è¿è¡Œ Docker
- âœ… æ‰§è¡ŒåŸºç¡€ Docker å‘½ä»¤éªŒè¯å®‰è£…

---

## ğŸ” Docker Desktop vs Docker Engine

åœ¨å¼€å§‹å®‰è£…å‰ï¼Œå…ˆäº†è§£ä¸¤ç§ Docker äº§å“çš„åŒºåˆ«ï¼š

### Docker Engineï¼ˆå¼•æ“ï¼‰

Docker Engine æ˜¯ Docker çš„**æ ¸å¿ƒç»„ä»¶**ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§è¿è¡Œæ—¶ï¼š

- ğŸ–¥ï¸ **é€‚ç”¨å¹³å°**ï¼šLinux æœåŠ¡å™¨
- ğŸ“¦ **å®‰è£…æ–¹å¼**ï¼š`apt` / `yum` åŒ…ç®¡ç†å™¨
- ğŸ”§ **ç•Œé¢**ï¼šä»…å‘½ä»¤è¡Œ
- ğŸ’° **ä»·æ ¼**ï¼šå®Œå…¨å…è´¹

### Docker Desktopï¼ˆæ¡Œé¢ç‰ˆï¼‰

Docker Desktop æ˜¯é¢å‘å¼€å‘è€…çš„**å®Œæ•´åº”ç”¨ç¨‹åº**ï¼š

- ğŸ–¥ï¸ **é€‚ç”¨å¹³å°**ï¼šmacOS / Windows
- ğŸ“¦ **åŒ…å«ç»„ä»¶**ï¼šDocker Engine + GUI + Compose + Kubernetes
- ğŸ”§ **ç•Œé¢**ï¼šå›¾å½¢åŒ– + å‘½ä»¤è¡Œ
- ğŸ’° **ä»·æ ¼**ï¼šä¸ªäºº/å°å›¢é˜Ÿå…è´¹ï¼Œå¤§ä¼ä¸šéœ€ä»˜è´¹

### å¦‚ä½•é€‰æ‹©ï¼Ÿ

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ |
|------|----------|
| æœ¬åœ° macOS å¼€å‘ | Docker Desktop |
| æœ¬åœ° Windows å¼€å‘ | Docker Desktop |
| æœ¬åœ° Ubuntu æ¡Œé¢ | Docker Desktop æˆ– Engine |
| äº‘æœåŠ¡å™¨ (Linux) | **Docker Engine** |
| ç”Ÿäº§æœåŠ¡å™¨ | **Docker Engine** |

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šDocker Desktop å†…éƒ¨è¿è¡Œäº†ä¸€ä¸ª Linux è™šæ‹Ÿæœºæ¥æ‰§è¡Œ Engineï¼Œæ‰€ä»¥åœ¨ macOS ä¸Šæ‰§è¡Œçš„ `docker` å‘½ä»¤å®é™…æ˜¯ä¸è™šæ‹Ÿæœºä¸­çš„ Engine é€šä¿¡ã€‚

---

## ğŸ macOS å®‰è£…

### ç³»ç»Ÿè¦æ±‚

| èŠ¯ç‰‡ç±»å‹ | æœ€ä½ macOS ç‰ˆæœ¬ | å†…å­˜å»ºè®® |
|----------|-----------------|----------|
| Apple Silicon (M1/M2/M3/M4) | macOS 12.0+ | 8GB+ |
| Intel | macOS 12.0+ | 8GB+ |

### å®‰è£…æ­¥éª¤

#### æ–¹å¼ä¸€ï¼šå®˜ç½‘ä¸‹è½½ï¼ˆæ¨èï¼‰

1. **ä¸‹è½½ Docker Desktop**

   è®¿é—® [Docker Desktop å®˜æ–¹ä¸‹è½½é¡µ](https://www.docker.com/products/docker-desktop/)

   > âš ï¸ **æ³¨æ„**ï¼šè¯·æ ¹æ®ä½ çš„èŠ¯ç‰‡ç±»å‹é€‰æ‹©å¯¹åº”ç‰ˆæœ¬ï¼š
   > - Apple Silicon (M1/M2/M3/M4)ï¼šä¸‹è½½ **Apple Silicon** ç‰ˆæœ¬
   > - Intelï¼šä¸‹è½½ **Intel Chip** ç‰ˆæœ¬

   **å¦‚ä½•ç¡®è®¤èŠ¯ç‰‡ç±»å‹**ï¼š
   ```bash
   # åœ¨ç»ˆç«¯æ‰§è¡Œ
   uname -m
   # arm64 = Apple Silicon
   # x86_64 = Intel
   ```

2. **å®‰è£…åº”ç”¨**

   - åŒå‡»ä¸‹è½½çš„ `.dmg` æ–‡ä»¶
   - å°† Docker å›¾æ ‡æ‹–åˆ° Applications æ–‡ä»¶å¤¹
   - ä»å¯åŠ¨å°æ‰“å¼€ Docker
   - é¦–æ¬¡å¯åŠ¨éœ€è¦æˆæƒï¼Œè¾“å…¥ç³»ç»Ÿå¯†ç 

3. **ç­‰å¾…å¯åŠ¨å®Œæˆ**

   Docker å›¾æ ‡åœ¨èœå•æ æ˜¾ç¤ºåŠ¨ç”»æ—¶è¡¨ç¤ºæ­£åœ¨å¯åŠ¨ï¼Œç¨³å®šåå³å¯ä½¿ç”¨ã€‚

#### æ–¹å¼äºŒï¼šHomebrew å®‰è£…

å¦‚æœä½ å·²å®‰è£… [Homebrew](https://brew.sh/)ï¼š

```bash
# å®‰è£… Docker Desktop (cask)
brew install --cask docker

# å®‰è£…åæ‰‹åŠ¨æ‰“å¼€ Docker.app
open /Applications/Docker.app
```

### éªŒè¯å®‰è£…

```bash
# æŸ¥çœ‹ Docker ç‰ˆæœ¬
docker --version
# è¾“å‡ºç¤ºä¾‹ï¼šDocker version 24.0.7, build afdd53b

# æŸ¥çœ‹ Docker Compose ç‰ˆæœ¬
docker compose version
# è¾“å‡ºç¤ºä¾‹ï¼šDocker Compose version v2.23.0-desktop.1

# è¿è¡Œæµ‹è¯•å®¹å™¨
docker run hello-world
```

å¦‚æœçœ‹åˆ° `Hello from Docker!` æ¶ˆæ¯ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼

### æ¨èé…ç½®

æ‰“å¼€ Docker Desktop â†’ Settings â†’ Resourcesï¼š

| é…ç½®é¡¹ | æ¨èå€¼ | è¯´æ˜ |
|--------|--------|------|
| CPUs | 4+ | æœ¬é¡¹ç›®å»ºè®®è‡³å°‘ 4 æ ¸ |
| Memory | 8GB+ | Ollama éœ€è¦è¾ƒå¤§å†…å­˜ |
| Disk | 100GB+ | AI æ¨¡å‹æ–‡ä»¶è¾ƒå¤§ |

---

## â˜ï¸ äº‘æœåŠ¡å™¨éƒ¨ç½²

> å¦‚æœä½ ä½¿ç”¨é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ç­‰äº‘æœåŠ¡å™¨ï¼Œè¯·å‚è€ƒæœ¬èŠ‚ã€‚

### å‰ç½®å‡†å¤‡

#### 1. æœåŠ¡å™¨é…ç½®å»ºè®®

| é…ç½®é¡¹ | æœ€ä½è¦æ±‚ | æ¨èé…ç½® |
|--------|----------|----------|
| CPU | 2 æ ¸ | 4 æ ¸+ |
| å†…å­˜ | 4GB | 8GB+ï¼ˆè¿è¡Œ Ollama å¿…éœ€ï¼‰ |
| ç³»ç»Ÿç›˜ | 40GB | 100GB+ï¼ˆAI æ¨¡å‹è¾ƒå¤§ï¼‰ |
| æ“ä½œç³»ç»Ÿ | Ubuntu 20.04/22.04 | Ubuntu 22.04 LTS |

#### 2. å®‰å…¨ç»„é…ç½®ï¼ˆé‡è¦ï¼ï¼‰

åœ¨äº‘å‚å•†æ§åˆ¶å°é…ç½®å®‰å…¨ç»„/é˜²ç«å¢™è§„åˆ™ï¼Œæ”¾è¡Œä»¥ä¸‹ç«¯å£ï¼š

| ç«¯å£ | åè®® | ç”¨é€” | å¤‡æ³¨ |
|------|------|------|------|
| 22 | TCP | SSH | å¿…é¡» |
| 80 | TCP | HTTP | Nginx |
| 443 | TCP | HTTPS | Nginx |
| 8090 | TCP | åç«¯ API | å¯é€‰ï¼Œç›´è¿åç«¯æ—¶å¼€æ”¾ |

> âš ï¸ **å®‰å…¨æç¤º**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä»…å¼€æ”¾ 80/443ï¼Œåç«¯ API é€šè¿‡ Nginx ä»£ç†è®¿é—®ã€‚

### è¿æ¥æœåŠ¡å™¨

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯†ç 

```bash
ssh root@<æœåŠ¡å™¨å…¬ç½‘IP>
# è¾“å…¥å¯†ç åå›è½¦
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨ SSH å¯†é’¥ï¼ˆæ¨èï¼‰

```bash
# 1. æœ¬åœ°ç”Ÿæˆå¯†é’¥ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
ssh-keygen -t ed25519 -C "your_email@example.com"

# 2. å°†å…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨
ssh-copy-id root@<æœåŠ¡å™¨å…¬ç½‘IP>

# 3. å…å¯†ç™»å½•
ssh root@<æœåŠ¡å™¨å…¬ç½‘IP>
```

#### åˆ›å»ºé root ç”¨æˆ·ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºç”¨æˆ·
adduser deploy

# èµ‹äºˆ sudo æƒé™
usermod -aG sudo deploy

# åˆ‡æ¢åˆ°æ–°ç”¨æˆ·
su - deploy
```

### æœåŠ¡å™¨åˆå§‹åŒ–

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt-get update && sudo apt-get upgrade -y

# å®‰è£…å¸¸ç”¨å·¥å…·
sudo apt-get install -y git curl wget vim htop

# è®¾ç½®æ—¶åŒº
sudo timedatectl set-timezone Asia/Shanghai

# éªŒè¯æ—¶åŒº
date
```

### æ¥ä¸‹æ¥...

å®ŒæˆæœåŠ¡å™¨åˆå§‹åŒ–åï¼Œç»§ç»­ä¸‹æ–¹çš„ **Ubuntu å®‰è£…** ç« èŠ‚å®‰è£… Docker Engineã€‚

> ğŸ’¡ **æç¤º**ï¼šäº‘æœåŠ¡å™¨é€šå¸¸é¢„è£…äº† Dockerï¼Œå¯å…ˆæ‰§è¡Œ `docker --version` æ£€æŸ¥æ˜¯å¦å·²å®‰è£…ã€‚

---

## ğŸ§ Ubuntu å®‰è£…

### ç³»ç»Ÿè¦æ±‚

- Ubuntu 20.04 / 22.04 / 24.04 (LTS ç‰ˆæœ¬)
- 64 ä½ç³»ç»Ÿ
- è‡³å°‘ 4GB å†…å­˜ï¼ˆæ¨è 8GB+ï¼‰

### å®‰è£…æ­¥éª¤

#### 1. å¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœ‰ï¼‰

```bash
sudo apt-get remove docker docker-engine docker.io containerd runc
```

#### 2. å®‰è£…ä¾èµ–

```bash
sudo apt-get update
sudo apt-get install -y \
    ca-certificates \
    curl \
    gnupg \
    lsb-release
```

#### 3. æ·»åŠ  Docker å®˜æ–¹ GPG å¯†é’¥

```bash
sudo mkdir -m 0755 -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
    sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
```

#### 4. è®¾ç½®ä»“åº“

```bash
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

#### 5. å®‰è£… Docker Engine

```bash
sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
```

#### 6. é…ç½®é root ç”¨æˆ·ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
# åˆ›å»º docker ç»„ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
sudo groupadd docker

# å°†å½“å‰ç”¨æˆ·åŠ å…¥ docker ç»„
sudo usermod -aG docker $USER

# é‡æ–°ç™»å½•æˆ–æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä½¿é…ç½®ç”Ÿæ•ˆ
newgrp docker
```

### éªŒè¯å®‰è£…

```bash
# æŸ¥çœ‹ç‰ˆæœ¬
docker --version
docker compose version

# æµ‹è¯•è¿è¡Œ
docker run hello-world

# æŸ¥çœ‹ Docker æœåŠ¡çŠ¶æ€
sudo systemctl status docker
```

### è®¾ç½®å¼€æœºè‡ªå¯

```bash
sudo systemctl enable docker
sudo systemctl enable containerd
```

---

## ğŸ”§ é•œåƒåŠ é€Ÿé…ç½®ï¼ˆå›½å†…ç”¨æˆ·æ¨èï¼‰

å¦‚æœä½ åœ¨ä¸­å›½å¤§é™†ï¼Œæ‹‰å–é•œåƒå¯èƒ½è¾ƒæ…¢ï¼Œå¯é…ç½®é•œåƒåŠ é€Ÿå™¨ã€‚

### macOS é…ç½®

1. æ‰“å¼€ Docker Desktop â†’ Settings â†’ Docker Engine
2. åœ¨ JSON é…ç½®ä¸­æ·»åŠ ï¼š

```json
{
  "registry-mirrors": [
    "https://docker.1ms.run",
    "https://docker.xuanyuan.me"
  ]
}
```

3. ç‚¹å‡» **Apply & Restart**

### Ubuntu é…ç½®

```bash
# åˆ›å»ºæˆ–ç¼–è¾‘ daemon.json
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<EOF
{
  "registry-mirrors": [
    "https://docker.1ms.run",
    "https://docker.xuanyuan.me"
  ]
}
EOF

# é‡å¯ Docker æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl restart docker
```

### éªŒè¯åŠ é€Ÿé…ç½®

```bash
docker info | grep -A 5 "Registry Mirrors"
```

---

## ğŸ“ å‡†å¤‡é¡¹ç›®ç›®å½•

ç¡®ä¿ä½ å·²è·å–é¡¹ç›®ä»£ç ï¼š

```bash
# å¦‚æœä½¿ç”¨ Git
git clone <your-repo-url> ~/xiaofu/ai-rag-knowledge-study

# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/xiaofu/ai-rag-knowledge-study

# ç¡®è®¤ç›®å½•ç»“æ„
ls -la
# åº”çœ‹åˆ°ï¼špom.xml, xfg-dev-tech-app/, .claude/ ç­‰ç›®å½•
```

---

## âœ… æœ¬ç« æ£€æŸ¥æ¸…å•

åœ¨è¿›å…¥ä¸‹ä¸€ç« ä¹‹å‰ï¼Œè¯·ç¡®ä¿ï¼š

- [ ] Docker å·²å®‰è£…å¹¶èƒ½å¯åŠ¨
- [ ] `docker --version` æ­£å¸¸è¾“å‡ºç‰ˆæœ¬å·
- [ ] `docker compose version` æ­£å¸¸è¾“å‡ºç‰ˆæœ¬å·
- [ ] `docker run hello-world` æˆåŠŸæ‰§è¡Œ
- [ ] ï¼ˆå¯é€‰ï¼‰å·²é…ç½®é•œåƒåŠ é€Ÿ
- [ ] é¡¹ç›®ä»£ç å·²ä¸‹è½½åˆ°æœ¬åœ°

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| ä¸Šä¸€ç¯‡ | ä¸‹ä¸€ç¯‡ |
|--------|--------|
| - | [02-Docker åŸºç¡€æ¦‚å¿µ](./02-DockeråŸºç¡€æ¦‚å¿µ.md) |

[è¿”å›ç›®å½•](./README.md)
